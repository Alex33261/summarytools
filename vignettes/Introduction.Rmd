---
title: "Introduction to summarytools"
author: "Dominic Comtois"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette: 
    css: 
    - !expr system.file("rmarkdown/templates/html_vignette/resources/vignette.css", package = "rmarkdown")
vignette: >
  %\VignetteIndexEntry{Introduction to summarytools}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{magrittr}
  %\VignetteDepends{forcats}
---

```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(comment = NA, prompt = FALSE, cache = FALSE, results = 'asis')
library(summarytools)
st_options(plain.ascii = FALSE,
           style = "rmarkdown",
           footnote = NA,
           subtitle.emphasis = FALSE)
```

```{r, echo=FALSE}
st_css()
```

# Overview

**summarytools** is a data exploration and reporting tool built around four core functions:

| Function | Description |
|:--------------------------------------:|-----------------------------------------------------------------------------------------------------------------------------------|
| <a href="#freq">`freq()`</a> | **frequency tables** with proportions, cumulative proportions and missing data information |
| <a href="#ctable">`ctable()`</a> | **cross-tabulations** between two factors or any discrete data, with total, rows or columns proportions, as well as marginal sums |
| <a href="#descr">`descr()`</a> | **descriptive (univariate) statistics** for numerical data |
| <a href="#dfsummary">`dfSummary()`</a> | Extensive **data frame summaries** that facilitate data cleaning and firsthand evaluation |

It was developped with the following objectives in mind:

  - Provide a coherent set of descriptive functions comparable to those
    offered in commercial statistical packages such as SAS, SPSS and Stata
  - Offer flexibility in terms of output formats and contents
  - Integrate well with [Rmarkdown](https://rmarkdown.rstudio.com/) and 
    [knitr](https://yihui.org/knitr/) while also allowing stand-alone, 
    simple report generation

## Output Options

Results can be:

  - Displayed in the *R* console as plain text (default behavior)
  - Displayed in RStudio's Viewer or Web Browser with the `view()` function
  - Written to files in plain text, *markdown* or *html*
  - Used in *Rmarkdown* documents inside
    [knitr](https://cran.r-project.org/package=knitr)
    code chunks

## Other Characteristics

  - Support for pipe operators:
    + `%>%` and `%$%` 
      from [magrittr](https://cran.r-project.org/package=magrittr)
    + `%>>%` from [pipeR](https://cran.r-project.org/package=pipeR)
  - Multi-Lingual: 
    + French, Spanish, Russian and Turkish translations are built-in
    + Users can define additionnal languages as needed
  - Global options can be set to avoid redundancy in function calls

## This Vignette's Setup

This vignette was created with *Rmarkdown* using the `rmarkdown::html_vignette` theme. 
The setup chunk is as follows:

```
# ```{r setup, include=FALSE}
# library(knitr)
# opts_chunk$set(results = 'asis',      # This is essential (can also be set at the chunk-level)
#                comment = NA, 
#                prompt  = FALSE, 
#                cache   = FALSE)
#
# library(summarytools)
# st_options(plain.ascii = FALSE,       # To be used in Rmd documents
#            style       = "rmarkdown"  # To be used in Rmd documents
#            footnote    = NA,          # Avoids footnotes which would clutter the results
#            subtitle.emphasis = FALSE  # This will improve the layout with some rmarkdown
#                                       # themes (rmarkdown::html_vignette in the present case)
# )
# ```

# ```{r, echo=FALSE}
# st_css()                              # This is a must; without it, expect odd layout
# ```
```
<br/>

<a id="functions"></a>
# Core Function #1: freq() (Frequency Tables)<a id="freq"></a>

The `freq()` function generates a frequency table with counts and
proportions.

```{r}
library(summarytools)
freq(iris$Species, plain.ascii = FALSE, style = "rmarkdown")
```

In this first example, We've used the `plain.ascii` and `style` arguments.
However, since we have defined these globally using `st_options()`
in the setup chunk, we will leave them out from hereon as they are
redundant.

If we do not worry about missing data, we can set `report.nas = FALSE`:

```{r}
freq(iris$Species, report.nas = FALSE, headings = FALSE)
```

We can simplify further by omitting the *Totals* row, as well as 
the *cumulative* column:

```{r}
freq(iris$Species, report.nas = FALSE, totals = FALSE, 
     cumul = FALSE, headings = FALSE)
```

To get familiar with the various output styles, try out different values for 
`style` -- “simple”, “rmarkdown”, and “grid”. Here, the "rmarkdown" style was
used, as defined in the setup chunk.

### Subsetting Rows in Frequency Tables

The "rows" argument allows subsetting the resulting table; we can
use it in 3 different ways:

  - To select rows by position, we use a numerical vector; `rows = 1:10` will
    show the frequencies for the first 10 values only
  - To select rows by name, we either use
    + a character vector specifying row names
    + a single character string to be used as a regular expression;
      only the matching column(s) will be displayed
    
Used in combination with the "order" argument, this can be quite practical.
Say we have a character variable containing *many* distinct values; to report
only the 5 most frequent, we use `order = "freq"` along with
`rows = 1:5`. 

```{r}
freq(tobacco$disease, order = "freq", rows = 1:5)
```

The "(Other)" row is generated automatically; it combines the
frequencies of the values which are not shown explicitly.

### Generating Several Frequency Tables at Once

Although using `lapply()` is possible, a simpler method is to pass
the whole data frame to `freq()`: (results not shown)

```{r, eval=FALSE}
freq(tobacco)
```

Numerical columns having more than 25 distinct values will be discarded.
Il is possible to change this threshold using `st_options()`:

```{r, eval=FALSE}
st_options(freq.ignore.threshold = 15)
```


```{r, eval=FALSE}
view(freq(tobacco), collapse = TRUE)
```


# Core Function #2: ctable() (Cross-Tabulations)<a id="ctable"></a>

Using the sample data frame called *tobacco*, which is part of the package,
we will cross-tabulate two categorical variables: `smoker` and `diseased`.

Since *markdown* does not (yet) support multiline table headings, we’ll show a
rendered *html* version of the results using the generic `print()` function:

```{r}
print(ctable(tobacco$smoker, tobacco$diseased, prop = "r"),
      method = "render")
```

Remember that The **knitr** chunk option `results` **needs to be set to “asis”**
in order to get properly formatted results.

By default, `ctable()` shows *row proportions*. To show column or total
proportions, use `prop = "c"` or `prop = "t"`, respectively. To omit
proportions, use `prop = "n"`.

Now let's generate a simple “2 x 2” table (no proportions, no totals):

```{r}
with(tobacco, 
     print(ctable(smoker, diseased, prop = 'n', totals = FALSE),
           headings = FALSE, method = "render"))
```

### Chi-Square Results

To display chi-square results below the table, we need to set `chisq = TRUE`.
This time, instead of using nested function calls, we'll use the `%$%` and
`%>%` operators from the **magrittr** package:

```{r}
library(magrittr)
tobacco %$% 
  ctable(gender, smoker, chisq = TRUE, headings = FALSE) %>%
  print(method = "render")
```

Note that a warning will be issued when at least one *expected* cell
count is lower than 5.


# Core Function #3: descr() (Descriptive / Univariate Statisticss)<a id="descr"></a>

The `descr()` function generates common central tendency statistics and
measures of dispersion. It can handle single vectors as well as data frames,
in which case it ignores non-numerical columns (displaying a message to that
effect).

```{r}
descr(iris)
```

### Transposing, Selecting Statistics

If your eyes/brain prefer seeing things the other way around, just use
`transpose = TRUE`. We'll also select only the statistics we wish to
see.

```{r}
descr(iris, stats = c("mean", "sd"), transpose = TRUE, headings = FALSE)
```

See `?descr` for a complete list of available statistics. Special values “all” (default),
“fivenum”, and “common” are also valid.


# Core Function #4: dfSummary() (Extensive Data Summaries)<a id="dfsummary"></a>

`dfSummary()` collects information about all variables in a data frame and
displays it in a single legible table.

To generate a summary report and have it displayed in RStudio’s Viewer
pane (or in the default Web browser if working outside RStudio), we
simply do as follows:

```{r, eval=FALSE}
library(summarytools)
view(dfSummary(iris))
```
<img src="dfSummary_in_RStudio_Viewer.png" width=100% style="border:0" />

Of course, it is also possible to use `dfSummary()` in *Rmarkdown*
documents. It is usually a good idea to exclude a column or two,
otherwise the table might be a bit too wide. For instance, since the
*Valid* and *NA* columns are redundant, we can drop one of them.

```{r, eval=FALSE}
dfSummary(tobacco, plain.ascii = FALSE, style = "grid", 
          graph.magnif = 0.75, valid.col = FALSE, tmp.img.dir = "/tmp")
```
<img src="dfSummary_md.png" width=100%/>

While rendering *html* tables with `view()` doesn't require it, here it is
essential to specify `tmp.img.dir`. We'll explain why [further below](#tmp-img-dir).



# Grouped Statistics

## Using stby()

To avoid redundancy in the output's heading sections, **summarytools** has its own
version of the base `by()` function: `stby()`. We use it the exact same way we
would `by()`:

```{r}
(iris_stats_by_species <- stby(data = iris, 
                               INDICES = iris$Species, 
                               FUN = descr, stats = c("common"), transpose = TRUE))
```

**`descr()` Special Case**
When using `descr()` to produce grouped statistics for a single variable, results
are combined into a single table:


```{r}
data(tobacco)
with(tobacco, stby(data = BMI, INDICES = age.gr, 
                   FUN = descr, stats = c("mean", "sd", "min", "med", "max")))
```

When using `transpose = TRUE`, we get:

```{r, echo=FALSE}
BMI_by_age <- with(tobacco, 
                   stby(BMI, age.gr, descr, transpose = TRUE,
                        stats = c("mean", "sd", "min", "med", "max")))
print(BMI_by_age, headings = FALSE)
```

### Using stby() With ctable()

This is a little trickier -- the working syntax is as follows:

```{r, eval=FALSE}
stby(list(x = tobacco$smoker, y = tobacco$diseased), tobacco$gender, ctable)
# or equivalently
with(tobacco, stby(list(x = smoker, y = diseased), gender, ctable))
```

## Using dplyr::group_by() to Ventilate Results

To create grouped statistics with `descr()` or `dfSummary()`, it is possible
to use **dplyr**'s `group_by()` as an alternative to `stby()`. Aside from the
syntactic differences, one key distinction is that `dplyr::group_by()` considers
`NA` values on the grouping variables as valid categories, albeit with a warning
message suggesting to use `forcats::fct_explicit_na` to make `NA`'s explicit.
The best way to go is to actually follow that advice:

```{r, eval=FALSE}
library(dplyr)
tobacco$gender <- forcats::fct_explicit_na(tobacco$gender)
tobacco %>% group_by(gender) %>% descr(stats = "fivenum")
```

```{r, echo=FALSE}
suppressPackageStartupMessages(library(dplyr))
tobacco$gender <- forcats::fct_explicit_na(tobacco$gender)
tobacco %>% group_by(gender) %>% descr(stats = "fivenum")
```


## Collapsible Sections for freq()

When generating a frequency table with *html* format, use the
`collapse = TRUE` argument with `print()` or `view()` to get collapsible
sections; clicking on the variable name will collapse the frequency table
for that variable (results not shown).

## Tidy Tables With tb()
When generating `freq()` or `descr()` tables, it is possible to turn the
results into "tidy" tables with the use of the `tb()` function (think of
*tb* as a diminutive for *tibble*). For example:

```{r, results='markup'}
library(magrittr)
iris %>% descr(stats = "common") %>% tb()
iris$Species %>% freq(cumul = FALSE, report.nas = FALSE) %>% tb()
```

By definition, no total rows are part of *tidy* tables, and row.names are
converted to regular columns. 

### Tidy Split-Group Statistics

Here are two examples of how lists created using `stby()` are
transformed into *tibbles*. Notice how the *order* parameter affects the
table's row ordering:

```{r, results='markup'}
grouped_freqs <- stby(data = tobacco$smoker, INDICES = tobacco$gender,
                      FUN = freq, cumul = FALSE, report.nas = FALSE)
grouped_freqs %>% tb()
grouped_freqs %>% tb(order = 2)

grouped_descr <- stby(data = exams, INDICES = exams$gender, 
                      FUN = descr, stats = "common")
grouped_descr %>% tb()
grouped_descr %>% tb(order = 2)
```

# The print() and view() Functions

**summarytools** has a generic `print` method, `print.summarytools()`. By
default, its `method` argument is set to “pander”. One of the ways in
which `view()` is useful is that we can use it to easily display *html*
outputs in *RStudio*’s Viewer. The `view()` function simply acts as a
wrapper around `print.summarytools()`, specifying `method = 'viewer'`.
When used outside *RStudio*, `method` falls back to “browser” and the
report is shown in the default browser.


## Using summarytools in Rmarkdown Documents

As we have seen, **summarytools** can generate both text/*markdown* and
*html* results. Both types of outputs can be used in Rmarkdown documents.
The vignette
[Recommendations for Using summarytools With Rmarkdown](https://cran.r-project.org/package=summarytools/vignettes/Recommendations-rmarkdown.html)
provides good guidelines, but here are a few tips to get started:

 - Always set the `knitr` chunk option `results = 'asis'`. You can do
   this on a chunk-by-chunk basis, but it is easier to just set it globally
   in a "setup" chunk:

```{r, eval=FALSE, tidy=FALSE}
    knitr::opts_chunk$set(echo = TRUE, results = 'asis')
```

\ \ \ \ \ \ \ \ \ \ Refer to [this page](https://yihui.name/knitr/options/) for
more **knitr** options.

  - To get better results when generating *html* output with `method = 'render'`,
    set up your *.Rmd* document so that it includes **summarytools**’ css. The
    `st_css()` function makes this very easy.

#### Initial Setup -- Example

````
# ---
# title: "RMarkdown using summarytools"
# output: html_document
# ---
#
# ```{r setup, include=FALSE}
# library(knitr)
# opts_chunk$set(comment = NA, prompt = FALSE, cache = FALSE, results = 'asis')
# library(summarytools)
# st_options(plain.ascii = FALSE,          # This is a must in Rmd documents
#            style = "rmarkdown",          # idem
#            dfSummary.varnumbers = FALSE, # This keeps results narrow enough
#            dfSummary.valid.col = FALSE)  # idem
#```
#
# ```{r, echo=FALSE}
# st_css()
# ```
````

Since `results = 'asis'` can conflict with other packages' way of generating
results, it is sometimes best to use it for individual chunks only.


### Managing Lengthy dfSummary() Outputs in Rmarkdown Documents

For data frames containing numerous variables, we can use the `max.tbl.height`
argument to wrap the results in a scrollable window having the specified
height, in pixels. For instance:

```{r}
print(dfSummary(tobacco, valid.col = FALSE, graph.magnif = 0.75), 
      max.tbl.height = 300, method = "render")
```

## Writing Output to Files

We can use the `file` argument with `print()` or `view()` to indicate that we
want to save the results in a file, be it *html*, *Rmd*, *md*, or just plain
text (*txt*). The file extension indicates to **summarytools** what type of file
should be generated.

```{r, eval=FALSE}
view(iris_stats_by_species, file = "~/iris_stats_by_species.html")
```

## Appending Output Files

The `append` argument allows adding content to existing files generated by
**summarytools**. This is useful if you want to include several statistical
tables in a single file. It is a quick alternative to creating an *.Rmd* document.

## Generating PDF's

There is no direct way to create a *pdf* with **summarytool**. There are however
several tools that allow converting *html* documents into *pdf*'s. The most widely
used is most probably [Pandoc](https://pandoc.org), but for converting 
`dfSummary()` tables, better results can be achieved using
[WK<html>TOpdf](https://wkhtmltopdf.org/index.html).

### Example

```{r, eval=FALSE}
setwd("~/R")
library(summarytools)
print(dfSummary(iris), file = "iris_dfs.html")
system("wkhtmltopdf --javascript-delay 1 iris_dfs.html iris_dfs.pdf")
shell.exec("iris_dfs.pdf")        # Windows
system("xdg-open 'iris_dfs.pdf'") # Linux
system("open 'iris_dfs.pdf'")     # OS X
```

Note that on *Windows* systems, after installing [WK<html>TOpdf](https://wkhtmltopdf.org/index.html),
we need to add `C:\Program Files\wkhtmltopdf\bin` to the PATH environment variable.
 
For fine-tuned, multi-paged reports, a sensible approach would be to first use
*Rmarkdown*, perhaps in combination with RStudio's [pagedown](https://github.com/rstudio/pagedown)
package if pagination is desired, to generate an *html* document that will lend 
itself easily to a *pdf* conversion.


## Global options

The following options can be set with `st_options()`:

### General Options

| Option name               | Default   | Note                                            |
| ------------------------: | --------: | :---------------------------------------------- |
| style                     | “simple”  | Set to “rmarkdown” in .Rmd documents            |
| plain.ascii               |    TRUE   | Set to FALSE in .Rmd documents                  |
| round.digits              |       2   | Number of decimals to show                      |
| headings                  |    TRUE   | Formerly “omit.headings”                        |
| footnote                  | “default” | Personalize, or set to NA to omit               |
| display.labels            |    TRUE   | Show variable / data frame labels in headings   |
| bootstrap.css (*)         |    TRUE   | Include Bootstrap 4 css in *html* outputs       |
| custom.css                |      NA   | Path to your own css file                       |
| escape.pipe               |   FALSE   | Useful for some Pandoc conversions              |
| subtitle.emphasis         |    TRUE   | Controls headings formatting                    |
| lang                      |   “en”    | Language (always 2-letter, lowercase)           |

(*) Set to FALSE in Shiny apps

### Function-Specific Options

| Option name            |  Default | Note                                     |
| ---------------------: | -------: | :--------------------------------------- |
| freq.totals            |   TRUE   | Display totals row in freq()             |
| freq.report.nas        |   TRUE   | Display <NA> row and “valid” columns     |
| ctable.prop            |    “r”   | Display **r**ow proportions by default   |
| ctable.totals          |   TRUE   | Show marginal totals                     |
| descr.stats            |   “all”  | “fivenum”, “common” or vector of stats   |
| descr.transpose        |  FALSE   |                                          |
| descr.silent           |  FALSE   | Hide console messages                    |
| dfSummary.varnumbers   |   TRUE   | Show variable numbers in 1st col.        |
| dfSummary.labels.col   |   TRUE   | Show variable labels when present        |
| dfSummary.graph.col    |   TRUE   | Show graphs                              |
| dfSummary.valid.col    |   TRUE   | Include the Valid column in the output   |
| dfSummary.na.col       |   TRUE   | Include the Missing column in the output |
| dfSummary.graph.magnif |      1   | Zoom factor for bar plots and histograms |
| dfSummary.silent       |  FALSE   | Hide console messages                    |
| tmp.img.dir            |     NA   | Directory to store [temporary images](#tmp-img-dir) |


#### Examples

```{r, eval=FALSE}
st_options()                      # display all global options values
st_options('round.digits')        # display the value of a specific option
st_options(style = 'rmarkdown')   # change one or several options' values
st_options(footnote = NA)         # Turn off the footnote on all outputs.
                                  # This option was used prior to generating
                                  # the present document.
```

## Overriding formatting attributes

When a **summarytools** object is created, its formatting attributes are
stored within it. However, you can override most of them when using the
`print()` method or the `view()` function.

### Overriding Function-Specific Arguments


| Argument       | freq   | ctable | descr | dfSummary |
| -------------: | :----: | :----: | :---: | :-------: |
| style          |   x    |   x    |   x   |     x     |
| round.digits   |   x    |   x    |   x   |           |
| plain.ascii    |   x    |   x    |   x   |     x     |
| justify        |   x    |   x    |   x   |     x     |
| headings       |   x    |   x    |   x   |     x     |
| display.labels |   x    |   x    |   x   |     x     |
| varnumbers     |        |        |       |     x     |
| labels.col     |        |        |       |     x     |
| graph.col      |        |        |       |     x     |
| valid.col      |        |        |       |     x     |
| na.col         |        |        |       |     x     |
| col.widths     |        |        |       |     x     |
| totals         |   x    |   x    |       |           |
| report.nas     |   x    |        |       |           |
| display.type   |   x    |        |       |           |
| missing        |   x    |        |       |           |
| split.tables   |   x    |   x    |   x   |     x     |
| caption        |   x    |   x    |   x   |     x     |


### Overriding Headings Content

| Argument           | freq   | ctable | descr | dfSummary |
| -----------------: | :----: | :----: | :---: | :-------: |
| Data.frame         |   x    |   x    |   x   |     x     |
| Data.frame.label   |   x    |   x    |   x   |     x     |
| Variable           |   x    |   x    |   x   |           |
| Variable.label     |   x    |   x    |   x   |           |
| Group              |   x    |   x    |   x   |     x     |
| date               |   x    |   x    |   x   |     x     |
| Weights            |   x    |        |   x   |           |
| Data.type          |   x    |        |       |           |
| Row.variable       |        |   x    |       |           |
| Col.variable       |        |   x    |       |           |


#### Example 

Here's an example in which we override 3 function-specific arguments, and one
element of the heading:

```{r}
(age_stats <- freq(tobacco$age.gr)) 
print(age_stats, report.nas = FALSE, totals = FALSE, display.type = FALSE,
      Variable.label = "Age Group")
```

Note that the original attributes are still part of the *age\_stats* object,
left unchanged.

## Order of Priority for Options / Parameters

1.  Options overridden explicitly in `print()` or `view()` have
    precedence
2.  Options specified as explicit arguments to `freq() / ctable() /
    descr() / dfSummary()` come second
3.  Global options set with `st_options` come third

## Customizing looks with CSS

**summarytools** uses *RStudio*’s
[htmltools package](https://CRAN.R-project.org/package=htmltools)
and version 4 of [Bootstrap](https://getbootstrap.com/)’s cascading
stylesheets.

It is possible to include your own *css* if you wish to customize the
look of the output tables. See `?print.summarytools` for all the details,
but here is a quick example.

Say you need to make the font size really really small. For this,
you would create a *.css* file - let’s call it “custom.css” -
containing a class definition such as the following:

```css
.tiny-text {
  font-size: 8px;
}
```
Then, to apply it to a **summarytools** object and display it in your
browser:

```{r, eval=FALSE}
view(dfSummary(tobacco), custom.css = 'path/to/custom.css', 
     table.classes = 'tiny-text')
```

To display a smaller table that is not **that** small, you can use the
**provided css class `st-small`**.

## Working with *Shiny* apps

To include **summarytools** functions in *Shiny* apps, it is recommended that 
you:

 - set `bootstrap.css = FALSE` to avoid interacting with the app's layout  
 - omit headings by setting the global option `headings = FALSE`
 - adjust the size of the graphs in `dfSummary()` using the `dfSummary.graph.magnif`
   global option
 - if `dfSummary()` outputs are too wide, try omitting a column or two
   (`valid.col` and `varnumbers`, for instance)
 - if needed, set the column widths manually with the `col.widths` parameter of the 
   `print()` method or the `view()` function
 
```{r, eval=FALSE}
print(dfSummary(somedata, graph.magnif = 0.8), 
      method = 'render',
      headings = FALSE,
      bootstrap.css = FALSE)
```

## Graphs in Markdown dfSummaries {#tmp-img-dir}

When generating *markdown* (as opposed to *html*) summaries in an *.Rmd* document,
three elements are needed to display proper *png* graphs:

  1 - `plain.ascii` is FALSE  
  2 - `style` is "grid"  
  3 - `tmp.img.dir` is defined  

Why the third element? Although *R* makes it really easy to 
create temporary files and directories, they do have long pathnames,
especially on Windows. Combine this with the fact that Pandoc currently
determines the final (rendered) column widths by counting characters, 
including those of pathnames pointing to images. What we get is... some
issues of proportion (!). 

At this time, there seems to be only one solution around this problem:
cut down on characters in pathnames. So instead of this:
```
+-----------+-------------------------------------------------------------------------+---------+
| Variable  | Graph                                                                   | Valid   |
+===========+=========================================================================+=========+
| gender\   | ![](C:/Users/johnny/AppData/Local/Temp/RtmpYRgetx/file5aa4549a4d71.png) | 978\    |
| [factor]  |                                                                         | (97.8%) |
+----+---------------+----------------------------------------------------------------+---------+
```

...we aim for this:
```
+---------------+----------------------+---------+
| Variable      | Graph                | Valid   |
+===============+======================+=========+
| gender\       | ![](/tmp/ds0001.png) | 978\    |
| [factor]      |                      | (97.8%) |
+---------------+----------------------+---------+
```

Now CRAN policies are really strict when it comes to writing content in 
the user directories, or anywhere outside *R's temporary zone* (for good 
reasons). So we need to let the users set this location themselves,
therefore implicitly consenting to content being written outside _R's 
temporary zone_.

On Mac OS and Linux, using "/tmp" makes a lot of sense: it's short, and
it's self-cleaning. On Windows, there is no such convenient directory, so
we need to pick one -- be it absolute ("/tmp") or relative ("img",
or simply "."). Two things are to be kept in mind: it needs to be short
(5 characters max) and we need to clean it up manually.

## Translations

It is now possible to change the language used in the outputs. The following
languages are available, thanks to the R community's efforts:
French (*fr*), Portuguese (*pt*), Russian (*ru*), Spanish (*es*), and
Turkish (*tr*).

### Switching Languages

To switch languages, simply use 

```{r}
st_options(lang = "fr")
```

Any function will now produce outputs using that language:

```{r}
freq(iris$Species)
```

The language used for producing the object is stored within it as an attribute.
This is to avoid problems when switching languages between the moment the 
object is stored, and the moment at which it is printed.

### Non-UTF-8 Locales

On most Windows systems, it will be necessary to change the `LC_CTYPE` element
of the locale settings if the character set is not included in the current
locale. For instance, in order to get good results -- or rather, any results at
all -- with the Russian language in a "latin1" environment, we'll need to do
this:

```{r, eval = FALSE}
Sys.setlocale("LC_CTYPE", "russian")
st_options(lang = 'ru')
```

Then, to go back to default settings:

```{r, results='hide'}
Sys.setlocale("LC_CTYPE", "")
st_options(lang = "en")
```

### Defining and Using Custom Translations

Using the function `use_custom_lang()`, it is possible to add your own set of 
translations. To achieve this, get the 
[*csv* template](https://raw.githubusercontent.com/dcomtois/summarytools/master/translations/language_template.csv),
customize the +/- 70 items, and call `use_custom_lang()`, giving it as
sole argument the path to your edited *csv* file. Note that such
custom translations will not persist across R sessions. This means that
you should always have this *csv* file handy.

### Defining Specific Keywords

Sometimes, all you might want to do is change just a few keywords -- say you
would rather have "N" instead of "Freq" in the title row of `freq()` tables. No
need to create a full custom language for that. Rather, use `define_keywords()`.
Calling this function without any arguments will bring up, on systems that
support graphical devices (the vast majority, that is), an editable window
allowing the modify only the desired items. 

<img src="define_keywords.png" width=95% style="border:1;border-color:grey" />

After closing the edit window, you will be offered to export the resulting
"custom language" into a *csv* file that can be imported later on with
`use_custom_lang()`.

Note that it is also possible to define one or several keywords using function
arguments. For the list of all possible keywords to define, see `?define_keywords`.
For instance:

```{r, eval=FALSE}
define_keywords(freq = "N")
```

## Changes and Improvements Since Version 0.9 {#changes}

As stated earlier, version 0.9 brought many changes and improvements.
Here are the main ones:

 - **Translations**
 - **Improved printing of list objects**
   + Objects of class “stby” are automatically printed in the console with
     optimal results; no more need for `view(x, method = "pander")`;
     simply use `stby()` instead of `by()`
   + Regular lists containing **summarytools** objects can also be printed with
     optimal results simply by calling `print(x)` (as opposed to “stby” objects,
     their automatic printing will **not** be optimal; that being said, `freq()`
     now accepts data frames as its first argument, so the need for `lapply()`
     is greatly diminished)
 - **Easier management of global settings with `st_options()`**
   + `st_options()` now has as many parameters as there are
     options to set, making it possible to set all options 
     with only one function call; legacy way of setting
     options is still supported
   + Several global options were added, with a focus on simplifying 
     *Rmarkdown* document creation
 - **improved magrittr** operators support (`%>%`, `%$%`)
 - **Changes to `freq()`**
   + As mentioned earlier, the function now accepts data frames as its main 
     argument; this makes practically obsolete the use of `lapply()` with it
   + Improved outputs when using `stby()`
 - **Changes to `ctable()`**
   + Fully supports `stby()`
   + Improved number alignment
   + Added "chisq" parameter
 - **Changes to `descr()`**
   + For the `stats` argument, Values “fivenum” and “common” are now allowed,
     the latter representing the collection of *mean*, *sd*, *min*, *med*,
     *max*, *n.valid*, and *pct.valid*
   + Improved outputs when using `stby()` 
   + The variable used for weights (if any) is removed automatically from the
     data so no stats are produced for it
 - **Changes to `dfSummary()`**
   + Now fully compatible with *Rmarkdown* with its *png* graphs
   + Number of columns is included in the heading section
   + Number of duplicated rows is also shown in the heading section
   + Bar plots now more accurately reflect counts, as they are not stretched
     across table cells (this allows comparison of frequencies across 
     variables)
   + Columns with particular content (unary/binary, integer sequences, UPC/EAN
     codes) are treated differently; more relevant information is displayed,
     while irrelevant information is hidden
   + For *html* outputs, a new parameter `col.widths` can be used to set the
     width of the resulting table's columns; this addresses an issue
     with some graphs not being shown at the desired magnification level 
     (although much effort has been put into improving this as well)
   + `max.tbl.height` parameter added, allowing lengthy summaries to
     be shown in a scrollable window

### Other Notable Changes

 - The `omit.headings` parameter has been replaced by the more straightforward
   (and still boolean) `headings`. `omit.heandings` is deprecated as of 0.9.4.
 - Because it was subject to errors, the *Rows Subset* heading element
   has been removed. If there is a strong need for it, I can bring it back in a 
   future release (just let me known by email or on GitHub if you'd like to have
   it back)
 - Under the hood, much has been going on; the lengthier functions have been
   split into more manageable parts, and several normalizing operations were
   performed, facilitating maintenance and improving code readability
 - The `tb()` function turns results from `freq()` and `descr()` into 
   *tidy tibbles*

[Back to function descriptions](#functions)
   
## Stay Up-to-date

Check out the [GitHub project's page](https://github.com/dcomtois/summarytools) - 
from there you can see the latest updates and also submit feature requests.

For a preview of what's coming in the next release, have a look at the 
[development branch](https://github.com/dcomtois/summarytools/tree/dev-current).

## Final notes

The package comes with no guarantees. It is a work in progress and
feedback / feature requests are welcome. Just send an email to
dominic.comtois@gmail.com, or open an
[Issue on GitHub](https://github.com/dcomtois/summarytools/issues) if you find a
bug or wish to submit a feature request.
